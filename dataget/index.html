<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•™è‚²æ•°æ®é‡‡é›†ä¸AIåˆ†æå¹³å°</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
:root {
    --primary: #4361ee;
    --primary-light: #4895ef;
    --secondary: #3f37c9;
    --accent: #4cc9f0;
    --success: #4ade80;
    --warning: #f59e0b;
    --danger: #ef4444;
    --dark: #1e293b;
    --light: #f8fafc;
    --gray: #64748b;
    --gray-light: #e2e8f0;
    --border-radius: 12px;
    --shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
    --transition: all 0.3s ease;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Inter', sans-serif;
    background: linear-gradient(135deg, #f0f4ff 0%, #e6f0ff 100%);
    min-height: 100vh;
    color: var(--dark);
    line-height: 1.6;
}

.container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 30px;
}

.header {
    text-align: center;
    margin-bottom: 40px;
    position: relative;
}

.header h1 {
    font-size: 2.8rem;
    font-weight: 700;
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 15px;
    letter-spacing: -0.5px;
}

.header p {
    font-size: 1.2rem;
    color: var(--gray);
    max-width: 600px;
    margin: 0 auto;
}

.demo-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
    gap: 30px;
    margin-bottom: 40px;
}

.demo-card {
    background: white;
    border-radius: var(--border-radius);
    padding: 28px;
    box-shadow: var(--shadow);
    transition: var(--transition);
    position: relative;
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.demo-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background: linear-gradient(90deg, var(--primary), var(--accent));
}

.demo-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.15);
}

.demo-card h3 {
    color: var(--dark);
    margin-bottom: 18px;
    font-size: 1.4rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 10px;
}

.demo-card h3 .icon {
    width: 36px;
    height: 36px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(67, 97, 238, 0.1);
    color: var(--primary);
}

.demo-card > p {
    color: var(--gray);
    margin-bottom: 20px;
    font-size: 0.95rem;
}

.data-display {
    background: var(--light);
    border-radius: 10px;
    padding: 18px;
    margin: 18px 0;
    font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
    font-size: 0.9rem;
    max-height: 220px;
    overflow-y: auto;
    border-left: 4px solid var(--primary);
    transition: var(--transition);
}

.data-display:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}

.quiz-container {
    margin: 18px 0;
}

.question {
    margin-bottom: 18px;
    padding: 18px;
    background: rgba(67, 97, 238, 0.05);
    border-radius: 10px;
    border-left: 4px solid var(--primary);
}

.options label {
    display: flex;
    align-items: center;
    margin: 10px 0;
    cursor: pointer;
    padding: 12px;
    border-radius: 8px;
    transition: var(--transition);
    border: 1px solid transparent;
}

.options label:hover {
    background-color: rgba(67, 97, 238, 0.08);
    border-color: rgba(67, 97, 238, 0.2);
}

.options input {
    margin-right: 12px;
    transform: scale(1.2);
}

button {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1rem;
    font-weight: 500;
    transition: var(--transition);
    margin: 5px;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    box-shadow: 0 4px 12px rgba(67, 97, 238, 0.2);
}

button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 18px rgba(67, 97, 238, 0.3);
}

button.secondary {
    background: white;
    color: var(--primary);
    border: 1px solid var(--primary-light);
}

.timer {
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--primary);
    text-align: center;
    margin: 12px 0;
    padding: 10px;
    background: rgba(67, 97, 238, 0.05);
    border-radius: 8px;
}

.progress-bar {
    width: 100%;
    height: 10px;
    background: var(--gray-light);
    border-radius: 5px;
    overflow: hidden;
    margin: 15px 0;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--success), #22c55e);
    transition: width 0.5s ease;
    border-radius: 5px;
}

.typing-area {
    width: 100%;
    min-height: 120px;
    border: 2px solid var(--gray-light);
    border-radius: 10px;
    padding: 16px;
    font-family: 'Inter', sans-serif;
    font-size: 1rem;
    resize: vertical;
    transition: var(--transition);
    background: white;
}

.typing-area:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
}

.status {
    padding: 12px 16px;
    margin: 12px 0;
    border-radius: 8px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 10px;
}

.status.online {
    background: rgba(74, 222, 128, 0.15);
    color: #166534;
    border-left: 4px solid var(--success);
}

.status.idle {
    background: rgba(245, 158, 11, 0.15);
    color: #92400e;
    border-left: 4px solid var(--warning);
}

.heatmap {
    display: grid;
    grid-template-columns: repeat(10, 1fr);
    gap: 4px;
    margin: 18px 0;
    padding: 10px;
    background: var(--light);
    border-radius: 10px;
}

.heatmap-cell {
    aspect-ratio: 1;
    background: var(--gray-light);
    border-radius: 4px;
    transition: all 0.3s ease;
    cursor: pointer;
}

.heatmap-cell:hover {
    transform: scale(1.1);
}

.metrics {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
    gap: 18px;
    margin: 18px 0;
}

.metric-card {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
    color: white;
    padding: 18px;
    border-radius: 10px;
    text-align: center;
    box-shadow: 0 4px 12px rgba(67, 97, 238, 0.2);
    transition: var(--transition);
}

.metric-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(67, 97, 238, 0.3);
}

.metric-value {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 8px;
}

.metric-label {
    font-size: 0.9rem;
    opacity: 0.9;
}

.summary-panel {
    background: white;
    border-radius: var(--border-radius);
    padding: 32px;
    margin-top: 30px;
    box-shadow: var(--shadow);
    position: relative;
    overflow: hidden;
}

.summary-panel::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background: linear-gradient(90deg, var(--primary), var(--accent));
}

.summary-panel h2 {
    color: var(--dark);
    margin-bottom: 24px;
    text-align: center;
    font-size: 1.8rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
}

/* AIåˆ†æé¢æ¿æ ·å¼ */
.ai-panel {
    grid-column: span 1;
}

.ai-controls {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-bottom: 20px;
}

.ai-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 15px 10px;
    font-size: 0.85rem;
    text-align: center;
    height: auto;
    min-height: 70px;
}

.ai-btn.primary {
    grid-column: span 2;
    flex-direction: row;
    min-height: 60px;
}

.btn-icon {
    font-size: 1.2rem;
    margin-bottom: 5px;
}

.ai-btn.primary .btn-icon {
    margin-bottom: 0;
    margin-right: 8px;
}

.ai-analysis-container {
    position: relative;
    min-height: 200px;
    margin-bottom: 20px;
}

.ai-response {
    background: var(--light);
    border-radius: 10px;
    padding: 20px;
    border-left: 4px solid var(--primary);
    min-height: 200px;
    transition: var(--transition);
}

.ai-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    text-align: center;
    color: var(--gray);
}

.ai-icon {
    font-size: 3rem;
    margin-bottom: 15px;
    opacity: 0.7;
}

.ai-subtext {
    font-size: 0.9rem;
    margin-top: 5px;
    opacity: 0.7;
}

.ai-loading {
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    text-align: center;
}

.loading-spinner {
    width: 40px;
    height: 40px;
    border: 4px solid rgba(67, 97, 238, 0.2);
    border-left: 4px solid var(--primary);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-bottom: 15px;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.api-settings {
    margin-top: 15px;
    padding-top: 15px;
    border-top: 1px solid var(--gray-light);
}

.setting-item {
    display: flex;
    align-items: center;
    gap: 10px;
}

.setting-item label {
    font-size: 0.9rem;
    color: var(--gray);
}

.setting-item select {
    padding: 8px 12px;
    border: 1px solid var(--gray-light);
    border-radius: 6px;
    background: white;
    font-family: 'Inter', sans-serif;
}

/* AIå“åº”å†…å®¹æ ·å¼ */
.ai-analysis-result {
    animation: fadeIn 0.5s ease;
}

.ai-analysis-title {
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 10px;
    color: var(--primary);
    display: flex;
    align-items: center;
    gap: 8px;
}

.ai-analysis-content {
    line-height: 1.6;
}

.ai-suggestion {
    background: rgba(67, 97, 238, 0.05);
    padding: 12px 15px;
    border-radius: 8px;
    margin-top: 15px;
    border-left: 3px solid var(--primary);
}

.ai-suggestion-title {
    font-weight: 600;
    margin-bottom: 5px;
    color: var(--dark);
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
}

.recording {
    animation: pulse 2s infinite;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.demo-card, .summary-panel {
    animation: fadeIn 0.6s ease-out;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
    .container {
        padding: 20px;
    }
    
    .header h1 {
        font-size: 2.2rem;
    }
    
    .demo-grid {
        grid-template-columns: 1fr;
        gap: 20px;
    }
    
    .metrics {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .ai-controls {
        grid-template-columns: 1fr;
    }
    
    .ai-btn.primary {
        grid-column: span 1;
    }
}

/* æ»šåŠ¨æ¡ç¾åŒ– */
::-webkit-scrollbar {
    width: 8px;
}

::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 10px;
}

::-webkit-scrollbar-thumb {
    background: var(--primary-light);
    border-radius: 10px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--primary);
}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>æ•™è‚²æ•°æ®é‡‡é›†ä¸AIåˆ†æå¹³å°</h1>
            <p>å±•ç¤ºå‰ç«¯å¯å®ç°çš„å„ç§æ•™è‚²æ•°æ®é‡‡é›†æŠ€æœ¯ï¼Œå¹¶é›†æˆAIåˆ†æåŠŸèƒ½</p>
        </div>

        <div class="demo-grid">
            <!-- å­¦ä¹ è¡Œä¸ºè¿½è¸ª -->
            <div class="demo-card">
                <h3><span class="icon">ğŸ“Š</span>å­¦ä¹ è¡Œä¸ºè¿½è¸ª</h3>
                <p>å®æ—¶ç›‘æµ‹ç”¨æˆ·çš„é¡µé¢äº¤äº’è¡Œä¸ºï¼Œåˆ†æå­¦ä¹ ä¹ æƒ¯</p>
                <div class="data-display" id="behaviorData">
                    ç­‰å¾…ç”¨æˆ·äº¤äº’...
                </div>
                <div class="metrics">
                    <div class="metric-card">
                        <div class="metric-value" id="clickCount">0</div>
                        <div class="metric-label">ç‚¹å‡»æ¬¡æ•°</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="scrollDistance">0</div>
                        <div class="metric-label">æ»šåŠ¨è·ç¦»</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="timeOnPage">0</div>
                        <div class="metric-label">é¡µé¢åœç•™(ç§’)</div>
                    </div>
                </div>
            </div>

            <!-- ç­”é¢˜æ•°æ®é‡‡é›† -->
            <div class="demo-card">
                <h3><span class="icon">âœï¸</span>ç­”é¢˜è¡Œä¸ºåˆ†æ</h3>
                <div class="quiz-container">
                    <div class="timer" id="quizTimer">æ—¶é—´: 00:00</div>
                    <div class="question">
                        <p><strong>é¢˜ç›®:</strong> ä»¥ä¸‹å“ªä¸ªæ˜¯å‰ç«¯æ¡†æ¶ï¼Ÿ</p>
                        <div class="options">
                            <label><input type="radio" name="q1" value="A" data-question="1"> A. React</label>
                            <label><input type="radio" name="q1" value="B" data-question="1"> B. MySQL</label>
                            <label><input type="radio" name="q1" value="C" data-question="1"> C. Python</label>
                            <label><input type="radio" name="q1" value="D" data-question="1"> D. Docker</label>
                        </div>
                    </div>
                    <button onclick="submitQuiz()">æäº¤ç­”æ¡ˆ</button>
                </div>
                <div class="data-display" id="quizData">
                    ç­”é¢˜æ•°æ®å°†åœ¨è¿™é‡Œæ˜¾ç¤º...
                </div>
            </div>

            <!-- å­¦ä¹ ä¸“æ³¨åº¦ç›‘æµ‹ -->
            <div class="demo-card">
                <h3><span class="icon">ğŸ¯</span>ä¸“æ³¨åº¦ç›‘æµ‹</h3>
                <p>åŸºäºé¡µé¢ç„¦ç‚¹å’Œç”¨æˆ·æ´»è·ƒåº¦åˆ¤æ–­ä¸“æ³¨çŠ¶æ€</p>
                <div class="status" id="focusStatus">æ£€æµ‹ä¸­...</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="focusProgress" style="width: 0%"></div>
                </div>
                <div class="data-display" id="focusData">
                    ä¸“æ³¨åº¦æ•°æ®è®°å½•ä¸­...
                </div>
            </div>

            <!-- AIåˆ†æé¢æ¿ -->
            <div class="demo-card ai-panel">
                <h3><span class="icon">ğŸ¤–</span>AIå­¦ä¹ åˆ†æ</h3>
                <p>åŸºäºæ”¶é›†çš„æ•°æ®æä¾›ä¸ªæ€§åŒ–å­¦ä¹ å»ºè®®</p>
                
                <div class="ai-controls">
                    <button id="analyzeBehavior" class="ai-btn">
                        <span class="btn-icon">ğŸ“Š</span> åˆ†æå­¦ä¹ è¡Œä¸º
                    </button>
                    <button id="analyzeFocus" class="ai-btn">
                        <span class="btn-icon">ğŸ¯</span> åˆ†æä¸“æ³¨åº¦
                    </button>
                    <button id="analyzeQuiz" class="ai-btn">
                        <span class="btn-icon">âœï¸</span> åˆ†æç­”é¢˜æ¨¡å¼
                    </button>
                    <button id="comprehensiveAnalysis" class="ai-btn primary">
                        <span class="btn-icon">ğŸ§ </span> ç»¼åˆå­¦ä¹ åˆ†æ
                    </button>
                </div>
                
                <div class="ai-analysis-container">
                    <div class="ai-response" id="aiResponse">
                        <div class="ai-placeholder">
                            <div class="ai-icon">ğŸ¤–</div>
                            <p>ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹AIåˆ†æ</p>
                            <p class="ai-subtext">AIå°†æ ¹æ®æ‚¨çš„å­¦ä¹ æ•°æ®æä¾›ä¸ªæ€§åŒ–å»ºè®®</p>
                        </div>
                    </div>
                    
                    <div class="ai-loading" id="aiLoading">
                        <div class="loading-spinner"></div>
                        <p>AIæ­£åœ¨åˆ†ææ‚¨çš„å­¦ä¹ æ•°æ®...</p>
                    </div>
                </div>
                
                <div class="api-settings">
                    <div class="setting-item">
                        <label for="apiProvider">é€‰æ‹©AIæœåŠ¡:</label>
                        <select id="apiProvider">
                            <option value="deepseek">DeepSeek</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- å­¦ä¹ æ—¶é—´ç»Ÿè®¡ -->
            <div class="demo-card">
                <h3><span class="icon">â±ï¸</span>å­¦ä¹ æ—¶é—´ç»Ÿè®¡</h3>
                <p>è®°å½•å’Œåˆ†æå­¦ä¹ æ—¶é—´åˆ†å¸ƒï¼Œä¼˜åŒ–å­¦ä¹ æ•ˆç‡</p>
                <div class="metrics">
                    <div class="metric-card">
                        <div class="metric-value" id="activeTime">0</div>
                        <div class="metric-label">æ´»è·ƒæ—¶é—´(åˆ†)</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="idleTime">0</div>
                        <div class="metric-label">ç©ºé—²æ—¶é—´(åˆ†)</div>
                    </div>
                </div>
                <button onclick="startStudySession()">å¼€å§‹å­¦ä¹ </button>
                <button class="secondary" onclick="pauseStudySession()">æš‚åœ</button>
                <button class="secondary" onclick="endStudySession()">ç»“æŸ</button>
            </div>

            <!-- è¾“å…¥è¡Œä¸ºåˆ†æ -->
            <div class="demo-card">
                <h3><span class="icon">âŒ¨ï¸</span>è¾“å…¥è¡Œä¸ºåˆ†æ</h3>
                <p>åˆ†æç”¨æˆ·çš„æ‰“å­—æ¨¡å¼å’Œæ€è€ƒè¿‡ç¨‹ï¼Œè¯„ä¼°è®¤çŸ¥è´Ÿè·</p>
                <textarea class="typing-area" id="typingArea" placeholder="åœ¨è¿™é‡Œè¾“å…¥å†…å®¹ï¼Œç³»ç»Ÿä¼šåˆ†ææ‚¨çš„è¾“å…¥è¡Œä¸º..."></textarea>
                <div class="metrics">
                    <div class="metric-card">
                        <div class="metric-value" id="wpm">0</div>
                        <div class="metric-label">å­—/åˆ†é’Ÿ</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="pauseCount">0</div>
                        <div class="metric-label">æ€è€ƒåœé¡¿</div>
                    </div>
                </div>
                <div class="data-display" id="typingData">
                    è¾“å…¥åˆ†ææ•°æ®...
                </div>
            </div>

            <!-- ç‚¹å‡»çƒ­åŠ›å›¾ -->
            <div class="demo-card">
                <h3><span class="icon">ğŸ”¥</span>äº¤äº’çƒ­åŠ›å›¾</h3>
                <p>å¯è§†åŒ–ç”¨æˆ·çš„ç‚¹å‡»åˆ†å¸ƒæ¨¡å¼ï¼Œä¼˜åŒ–ç•Œé¢è®¾è®¡</p>
                <div class="heatmap" id="heatmap"></div>
                <button onclick="resetHeatmap()">é‡ç½®çƒ­åŠ›å›¾</button>
                <div class="data-display" id="heatmapData">
                    çƒ­åŠ›å›¾æ•°æ®ç»Ÿè®¡...
                </div>
            </div>
        </div>

        <!-- æ•°æ®æ±‡æ€»é¢æ¿ -->
        <div class="summary-panel">
            <h2><span>ğŸ“ˆ</span>æ•°æ®é‡‡é›†æ±‡æ€»</h2>
            <div class="data-display" id="summaryData" style="max-height: 300px;">
                ç»¼åˆæ•°æ®åˆ†æç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º...
            </div>
            <div style="margin-top: 20px; text-align: center;">
                <button onclick="exportData()">å¯¼å‡ºæ•°æ®</button>
                <button onclick="generateReport()">ç”ŸæˆæŠ¥å‘Š</button>
            </div>
        </div>
    </div>

    <script>
// å…¨å±€æ•°æ®å­˜å‚¨
const dataCollection = {
    behaviors: [],
    quizData: [],
    focusData: [],
    timeData: [],
    typingData: [],
    heatmapData: [],
    sessionStart: Date.now()
};

// DeepSeek APIé…ç½®
const DEEPSEEK_CONFIG = {
    apiKey: "sk-918e4cb06199406694dc0c1fcb54749a",
    baseURL: "https://api.deepseek.com/v1/chat/completions"
};

// é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
window.onload = function() {
    initializeDemos();
    updateSummary();
    
    // åˆå§‹åŒ–AIåˆ†æåŠŸèƒ½
    initAIAnalysis();
};

function initializeDemos() {
    // åˆå§‹åŒ–è¡Œä¸ºè¿½è¸ª
    initBehaviorTracking();
    // åˆå§‹åŒ–ä¸“æ³¨åº¦ç›‘æµ‹
    initFocusTracking();
    // åˆå§‹åŒ–è¾“å…¥åˆ†æ
    initTypingAnalysis();
    // åˆå§‹åŒ–çƒ­åŠ›å›¾
    initHeatmap();
    // åˆå§‹åŒ–æ—¶é—´ç»Ÿè®¡
    initTimeTracking();
    // åˆå§‹åŒ–ç­”é¢˜è®¡æ—¶
    initQuizTimer();
}

// 1. å­¦ä¹ è¡Œä¸ºè¿½è¸ª
function initBehaviorTracking() {
    let clickCount = 0;
    let scrollDistance = 0;
    let pageStartTime = Date.now();

    // ç‚¹å‡»äº‹ä»¶ç›‘å¬
    document.addEventListener('click', function(e) {
        clickCount++;
        const behaviorEvent = {
            type: 'click',
            timestamp: Date.now(),
            element: e.target.tagName,
            x: e.clientX,
            y: e.clientY
        };
        dataCollection.behaviors.push(behaviorEvent);
        
        document.getElementById('clickCount').textContent = clickCount;
        updateBehaviorDisplay();
    });

    // æ»šåŠ¨äº‹ä»¶ç›‘å¬
    let lastScrollTop = window.pageYOffset;
    window.addEventListener('scroll', function() {
        const currentScroll = window.pageYOffset;
        scrollDistance += Math.abs(currentScroll - lastScrollTop);
        lastScrollTop = currentScroll;
        
        document.getElementById('scrollDistance').textContent = Math.round(scrollDistance);
        
        dataCollection.behaviors.push({
            type: 'scroll',
            timestamp: Date.now(),
            distance: scrollDistance,
            position: currentScroll
        });
        updateBehaviorDisplay();
    });

    // æ›´æ–°é¡µé¢åœç•™æ—¶é—´
    setInterval(() => {
        const timeOnPage = Math.round((Date.now() - pageStartTime) / 1000);
        document.getElementById('timeOnPage').textContent = timeOnPage;
    }, 1000);
}

function updateBehaviorDisplay() {
    const recent = dataCollection.behaviors.slice(-5);
    const display = recent.map(event => 
        `${new Date(event.timestamp).toLocaleTimeString()}: ${event.type}`
    ).join('\n');
    document.getElementById('behaviorData').textContent = display || 'ç­‰å¾…ç”¨æˆ·äº¤äº’...';
}

// 2. ç­”é¢˜æ•°æ®é‡‡é›†
let quizStartTime = Date.now();
let quizTimer;

function initQuizTimer() {
    quizTimer = setInterval(updateQuizTimer, 1000);
}

function updateQuizTimer() {
    const elapsed = Date.now() - quizStartTime;
    const minutes = Math.floor(elapsed / 60000);
    const seconds = Math.floor((elapsed % 60000) / 1000);
    document.getElementById('quizTimer').textContent = 
        `æ—¶é—´: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
}

// ç›‘å¬ç­”é¢˜é€‰æ‹©
document.querySelectorAll('input[type="radio"]').forEach(radio => {
    radio.addEventListener('change', function() {
        const answerData = {
            question: this.dataset.question,
            answer: this.value,
            timestamp: Date.now(),
            timeSpent: Date.now() - quizStartTime
        };
        dataCollection.quizData.push(answerData);
        updateQuizDisplay();
    });
});

function submitQuiz() {
    const submission = {
        type: 'submit',
        timestamp: Date.now(),
        totalTime: Date.now() - quizStartTime,
        answers: dataCollection.quizData.filter(d => d.question)
    };
    dataCollection.quizData.push(submission);
    updateQuizDisplay();
    alert('ç­”é¢˜æ•°æ®å·²è®°å½•ï¼');
}

function updateQuizDisplay() {
    const display = dataCollection.quizData.map(data => 
        `é¢˜ç›®${data.question || '?'}: ${data.answer || data.type} (${(data.timeSpent/1000).toFixed(1)}s)`
    ).join('\n');
    document.getElementById('quizData').textContent = display || 'ç­”é¢˜æ•°æ®å°†åœ¨è¿™é‡Œæ˜¾ç¤º...';
}

// 3. ä¸“æ³¨åº¦ç›‘æµ‹
function initFocusTracking() {
    let focusScore = 0;
    let isActive = true;
    let lastActivity = Date.now();

    // é¡µé¢ç„¦ç‚¹äº‹ä»¶
    window.addEventListener('focus', () => {
        isActive = true;
        dataCollection.focusData.push({
            type: 'focus',
            timestamp: Date.now()
        });
        updateFocusStatus();
    });

    window.addEventListener('blur', () => {
        isActive = false;
        dataCollection.focusData.push({
            type: 'blur',
            timestamp: Date.now()
        });
        updateFocusStatus();
    });

    // é¼ æ ‡ç§»åŠ¨æ£€æµ‹æ´»è·ƒåº¦
    document.addEventListener('mousemove', () => {
        lastActivity = Date.now();
    });

    // å®šæœŸæ›´æ–°ä¸“æ³¨åº¦
    setInterval(() => {
        const timeSinceActivity = Date.now() - lastActivity;
        const isIdle = timeSinceActivity > 10000; // 10ç§’æ— æ´»åŠ¨è§†ä¸ºç©ºé—²
        
        if (isActive && !isIdle) {
            focusScore = Math.min(100, focusScore + 2);
        } else {
            focusScore = Math.max(0, focusScore - 1);
        }
        
        updateFocusProgress(focusScore);
        updateFocusStatus();
    }, 1000);
}

function updateFocusStatus() {
    const status = document.getElementById('focusStatus');
    const recent = dataCollection.focusData.slice(-1)[0];
    
    if (!recent || recent.type === 'focus') {
        status.textContent = 'ä¸“æ³¨ä¸­ ğŸ¯';
        status.className = 'status online';
    } else {
        status.textContent = 'æ³¨æ„åŠ›åˆ†æ•£ âš ï¸';
        status.className = 'status idle';
    }
}

function updateFocusProgress(score) {
    document.getElementById('focusProgress').style.width = score + '%';
    
    const focusRecord = {
        timestamp: Date.now(),
        focusScore: score,
        status: score > 70 ? 'focused' : score > 30 ? 'normal' : 'distracted'
    };
    dataCollection.focusData.push(focusRecord);
    
    const display = dataCollection.focusData.slice(-3).map(data => 
        `${new Date(data.timestamp).toLocaleTimeString()}: ${data.status} (${data.focusScore || 'N/A'})`
    ).join('\n');
    document.getElementById('focusData').textContent = display;
}

// 4. å­¦ä¹ æ—¶é—´ç»Ÿè®¡
let studySession = {
    isActive: false,
    startTime: null,
    activeTime: 0,
    idleTime: 0
};

function initTimeTracking() {
    updateTimeDisplay();
}

function startStudySession() {
    studySession.isActive = true;
    studySession.startTime = Date.now();
    dataCollection.timeData.push({
        type: 'session_start',
        timestamp: Date.now()
    });
    updateTimeDisplay();
}

function pauseStudySession() {
    if (studySession.isActive) {
        const sessionTime = Date.now() - studySession.startTime;
        studySession.activeTime += sessionTime;
        studySession.isActive = false;
        dataCollection.timeData.push({
            type: 'session_pause',
            timestamp: Date.now(),
            sessionDuration: sessionTime
        });
        updateTimeDisplay();
    }
}

function endStudySession() {
    if (studySession.isActive) {
        pauseStudySession();
    }
    dataCollection.timeData.push({
        type: 'session_end',
        timestamp: Date.now(),
        totalActive: studySession.activeTime,
        totalIdle: studySession.idleTime
    });
    alert('å­¦ä¹ ä¼šè¯å·²ç»“æŸï¼');
}

function updateTimeDisplay() {
    document.getElementById('activeTime').textContent = 
        Math.round(studySession.activeTime / 60000);
    document.getElementById('idleTime').textContent = 
        Math.round(studySession.idleTime / 60000);
}

// 5. è¾“å…¥è¡Œä¸ºåˆ†æ
function initTypingAnalysis() {
    const textArea = document.getElementById('typingArea');
    let typingStart = Date.now();
    let lastKeystroke = Date.now();
    let keystrokes = 0;
    let pauses = 0;
    let wordCount = 0;

    textArea.addEventListener('input', function(e) {
        const currentTime = Date.now();
        const timeSinceLastKey = currentTime - lastKeystroke;
        
        keystrokes++;
        
        // æ£€æµ‹æ€è€ƒåœé¡¿ï¼ˆå¤§äº2ç§’çš„é—´éš”ï¼‰
        if (timeSinceLastKey > 2000) {
            pauses++;
        }
        
        // è®¡ç®—æ‰“å­—é€Ÿåº¦
        const timeElapsed = (currentTime - typingStart) / 60000; // åˆ†é’Ÿ
        wordCount = this.value.split(/\s+/).filter(word => word.length > 0).length;
        const wpm = timeElapsed > 0 ? Math.round(wordCount / timeElapsed) : 0;
        
        // æ›´æ–°æ˜¾ç¤º
        document.getElementById('wpm').textContent = wpm;
        document.getElementById('pauseCount').textContent = pauses;
        
        // è®°å½•æ•°æ®
        dataCollection.typingData.push({
            timestamp: currentTime,
            keystroke: keystrokes,
            wpm: wpm,
            pauses: pauses,
            wordCount: wordCount
        });
        
        lastKeystroke = currentTime;
        updateTypingDisplay();
    });
}

function updateTypingDisplay() {
    const recent = dataCollection.typingData.slice(-1)[0];
    if (recent) {
        document.getElementById('typingData').textContent = 
            `æŒ‰é”®æ€»æ•°: ${recent.keystroke} | å½“å‰é€Ÿåº¦: ${recent.wpm} å­—/åˆ†é’Ÿ | æ€è€ƒåœé¡¿: ${recent.pauses} æ¬¡`;
    }
}

// 6. äº¤äº’çƒ­åŠ›å›¾
function initHeatmap() {
    const heatmap = document.getElementById('heatmap');
    
    // åˆ›å»º10x10ç½‘æ ¼
    for (let i = 0; i < 100; i++) {
        const cell = document.createElement('div');
        cell.className = 'heatmap-cell';
        cell.dataset.index = i;
        cell.addEventListener('click', handleHeatmapClick);
        heatmap.appendChild(cell);
    }
    
    updateHeatmapDisplay();
}

function handleHeatmapClick(e) {
    const index = parseInt(e.target.dataset.index);
    const existing = dataCollection.heatmapData.find(d => d.cell === index);
    
    if (existing) {
        existing.clicks++;
    } else {
        dataCollection.heatmapData.push({
            cell: index,
            clicks: 1,
            timestamp: Date.now()
        });
    }
    
    updateHeatmapVisual();
    updateHeatmapDisplay();
}

function updateHeatmapVisual() {
    const maxClicks = Math.max(...dataCollection.heatmapData.map(d => d.clicks), 1);
    
    dataCollection.heatmapData.forEach(data => {
        const cell = document.querySelector(`[data-index="${data.cell}"]`);
        const intensity = data.clicks / maxClicks;
        cell.style.backgroundColor = `rgba(67, 97, 238, ${intensity})`;
        cell.style.color = intensity > 0.5 ? 'white' : 'black';
        cell.textContent = data.clicks;
    });
}

function updateHeatmapDisplay() {
    const totalClicks = dataCollection.heatmapData.reduce((sum, d) => sum + d.clicks, 0);
    const mostClicked = dataCollection.heatmapData.reduce((max, d) => 
        d.clicks > (max.clicks || 0) ? d : max, {});
    
    const display = `æ€»ç‚¹å‡»: ${totalClicks} | æœ€çƒ­åŒºåŸŸ: ${mostClicked.cell || 'N/A'} (${mostClicked.clicks || 0}æ¬¡)`;
    document.getElementById('heatmapData').textContent = display;
}

function resetHeatmap() {
    dataCollection.heatmapData = [];
    document.querySelectorAll('.heatmap-cell').forEach(cell => {
        cell.style.backgroundColor = '';
        cell.textContent = '';
    });
    updateHeatmapDisplay();
}

// æ•°æ®æ±‡æ€»å’Œå¯¼å‡º
function updateSummary() {
    setInterval(() => {
        const totalEvents = dataCollection.behaviors.length + 
                          dataCollection.quizData.length + 
                          dataCollection.focusData.length + 
                          dataCollection.typingData.length;
        
        const sessionDuration = Math.round((Date.now() - dataCollection.sessionStart) / 60000);
        const averageFocus = calculateAverageFocus();
        const recentActivities = getRecentActivities();
        
        const summary = `ä¼šè¯æ—¶é•¿: ${sessionDuration} åˆ†é’Ÿ\næ€»äº‹ä»¶æ•°: ${totalEvents}\nå¹³å‡ä¸“æ³¨åº¦: ${averageFocus}%\n\næœ€è¿‘æ´»åŠ¨:\n${recentActivities}`;
        
        document.getElementById('summaryData').textContent = summary;
    }, 2000);
}

function calculateAverageFocus() {
    const focusScores = dataCollection.focusData
        .filter(d => d.focusScore !== undefined)
        .map(d => d.focusScore);
    return focusScores.length ? Math.round(
        focusScores.reduce((sum, score) => sum + score, 0) / focusScores.length
    ) : 0;
}

function getRecentActivities() {
    const allEvents = [
        ...dataCollection.behaviors.map(e => ({...e, source: 'behavior'})),
        ...dataCollection.quizData.map(e => ({...e, source: 'quiz'})),
        ...dataCollection.focusData.map(e => ({...e, source: 'focus'})),
        ...dataCollection.typingData.map(e => ({...e, source: 'typing'}))
    ].sort((a, b) => b.timestamp - a.timestamp).slice(0, 5);
    
    return allEvents.map(event => 
        `${new Date(event.timestamp).toLocaleTimeString()}: ${event.source} - ${event.type || 'activity'}`
    ).join('\n');
}

function exportData() {
    const exportData = {
        timestamp: new Date().toISOString(),
        sessionInfo: {
            startTime: dataCollection.sessionStart,
            duration: Date.now() - dataCollection.sessionStart
        },
        behaviors: dataCollection.behaviors,
        quizData: dataCollection.quizData,
        focusData: dataCollection.focusData,
        timeData: dataCollection.timeData,
        typingData: dataCollection.typingData,
        heatmapData: dataCollection.heatmapData
    };
    
    const blob = new Blob([JSON.stringify(exportData, null, 2)], {
        type: 'application/json'
    });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `education_data_${new Date().toISOString().slice(0, 10)}.json`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    alert('æ•°æ®å¯¼å‡ºæˆåŠŸï¼');
}

function generateReport() {
    const report = generateAnalysisReport();
    const blob = new Blob([report], { type: 'text/plain; charset=utf-8' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `education_analysis_report_${new Date().toISOString().slice(0, 10)}.txt`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    alert('åˆ†ææŠ¥å‘Šç”ŸæˆæˆåŠŸï¼');
}

function generateAnalysisReport() {
    const sessionDuration = (Date.now() - dataCollection.sessionStart) / 60000;
    const totalInteractions = dataCollection.behaviors.length;
    const averageFocus = calculateAverageFocus();
    
    return `
==============================================
æ•™è‚²æ•°æ®é‡‡é›†ä¸åˆ†ææŠ¥å‘Š
==============================================
ç”Ÿæˆæ—¶é—´: ${new Date().toLocaleString()}
ä¼šè¯æ—¶é•¿: ${sessionDuration.toFixed(1)} åˆ†é’Ÿ

ä¸€ã€å­¦ä¹ è¡Œä¸ºç»Ÿè®¡
----------------------------------------------
â€¢ æ€»äº¤äº’æ¬¡æ•°: ${totalInteractions}
â€¢ ç‚¹å‡»è¡Œä¸º: ${dataCollection.behaviors.filter(b => b.type === 'click').length}
â€¢ æ»šåŠ¨è¡Œä¸º: ${dataCollection.behaviors.filter(b => b.type === 'scroll').length}
â€¢ å¹³å‡æ¯åˆ†é’Ÿäº¤äº’: ${(totalInteractions / sessionDuration).toFixed(1)}

äºŒã€ç­”é¢˜è¡¨ç°åˆ†æ
----------------------------------------------
â€¢ ç­”é¢˜åŠ¨ä½œæ•°: ${dataCollection.quizData.length}
â€¢ å¹³å‡ç­”é¢˜æ—¶é—´: ${dataCollection.quizData.length ? 
    (dataCollection.quizData.reduce((sum, q) => sum + (q.timeSpent || 0), 0) / dataCollection.quizData.length / 1000).toFixed(1) : 0} ç§’

ä¸‰ã€ä¸“æ³¨åº¦è¯„ä¼°
----------------------------------------------
â€¢ å¹³å‡ä¸“æ³¨åº¦å¾—åˆ†: ${averageFocus}/100
â€¢ ä¸“æ³¨çŠ¶æ€å˜åŒ–æ¬¡æ•°: ${dataCollection.focusData.filter(f => f.type === 'focus' || f.type === 'blur').length}
â€¢ ä¸“æ³¨åº¦è¯„çº§: ${averageFocus > 80 ? 'ä¼˜ç§€' : averageFocus > 60 ? 'è‰¯å¥½' : averageFocus > 40 ? 'ä¸€èˆ¬' : 'éœ€æ”¹è¿›'}

å››ã€è¾“å…¥è¡Œä¸ºåˆ†æ
----------------------------------------------
â€¢ è¾“å…¥äº‹ä»¶æ€»æ•°: ${dataCollection.typingData.length}
â€¢ æ€è€ƒåœé¡¿æ¬¡æ•°: ${dataCollection.typingData.length ? dataCollection.typingData[dataCollection.typingData.length - 1].pauses : 0}
â€¢ æœ€ç»ˆæ‰“å­—é€Ÿåº¦: ${dataCollection.typingData.length ? dataCollection.typingData[dataCollection.typingData.length - 1].wpm : 0} å­—/åˆ†é’Ÿ

äº”ã€äº¤äº’çƒ­åŠ›åˆ†æ
----------------------------------------------
â€¢ çƒ­åŠ›å›¾æ€»ç‚¹å‡»: ${dataCollection.heatmapData.reduce((sum, d) => sum + d.clicks, 0)}
â€¢ æ´»è·ƒåŒºåŸŸæ•°é‡: ${dataCollection.heatmapData.length}
â€¢ äº¤äº’åˆ†å¸ƒ: ${dataCollection.heatmapData.length ? 'å­˜åœ¨æ˜æ˜¾çš„äº¤äº’åå¥½åŒºåŸŸ' : 'äº¤äº’åˆ†å¸ƒè¾ƒä¸ºå‡åŒ€'}

==============================================
æŠ¥å‘Šç»“æŸ
==============================================
    `.trim();
}

// ==================== AIåˆ†æåŠŸèƒ½ ====================

// åˆå§‹åŒ–AIåˆ†æåŠŸèƒ½
function initAIAnalysis() {
    // æ·»åŠ AIåˆ†ææŒ‰é’®äº‹ä»¶ç›‘å¬
    document.getElementById('analyzeBehavior').addEventListener('click', () => {
        analyzeWithDeepSeek('behavior');
    });
    
    document.getElementById('analyzeFocus').addEventListener('click', () => {
        analyzeWithDeepSeek('focus');
    });
    
    document.getElementById('analyzeQuiz').addEventListener('click', () => {
        analyzeWithDeepSeek('quiz');
    });
    
    document.getElementById('comprehensiveAnalysis').addEventListener('click', () => {
        analyzeWithDeepSeek('comprehensive');
    });
}

// æ˜¾ç¤ºAIåŠ è½½çŠ¶æ€
function showAILoading() {
    document.getElementById('aiResponse').style.display = 'none';
    document.getElementById('aiLoading').style.display = 'flex';
}

// éšè—AIåŠ è½½çŠ¶æ€
function hideAILoading() {
    document.getElementById('aiLoading').style.display = 'none';
    document.getElementById('aiResponse').style.display = 'block';
}

// æ˜¾ç¤ºAIå“åº”
function showAIResponse(content) {
    const aiResponse = document.getElementById('aiResponse');
    aiResponse.innerHTML = `
        <div class="ai-analysis-result">
            <div class="ai-analysis-title">
                <span>ğŸ¤–</span> AIåˆ†æç»“æœï¼ˆæ¼”ç¤ºæ¨¡å¼ï¼‰
            </div>
            <div class="ai-analysis-content">
                ${content}
            </div>
            <div class="ai-suggestion">
                <div class="ai-suggestion-title">ğŸ’¡ æ¸©é¦¨æç¤º</div>
                <p>è¿™æ˜¯æ¼”ç¤ºç‰ˆæœ¬ï¼Œå±•ç¤ºå‰ç«¯æ•°æ®é‡‡é›†ä¸AIåˆ†æé›†æˆçš„å¯èƒ½æ€§ã€‚</p>
            </div>
        </div>
    `;
    hideAILoading();
}

// æ¨¡æ‹ŸAIåˆ†æ
async function analyzeWithDeepSeek(analysisType) {
    showAILoading();
    
    // æ¨¡æ‹ŸAPIè°ƒç”¨å»¶è¿Ÿ
    await new Promise(resolve => setTimeout(resolve, 2000));
    
    const sessionDuration = Math.round((Date.now() - dataCollection.sessionStart) / 60000);
    const totalInteractions = dataCollection.behaviors.length;
    const averageFocus = calculateAverageFocus();
    
    let response = '';
    
    switch(analysisType) {
        case 'behavior':
            response = `
                <h4>ğŸ“Š å­¦ä¹ è¡Œä¸ºåˆ†æ</h4>
                <p><strong>æ´»è·ƒåº¦è¯„ä¼°ï¼š</strong>åœ¨${sessionDuration}åˆ†é’Ÿå†…ï¼Œæ‚¨äº§ç”Ÿäº†${totalInteractions}æ¬¡äº¤äº’ï¼Œå¹³å‡æ¯åˆ†é’Ÿ${(totalInteractions/sessionDuration).toFixed(1)}æ¬¡ï¼Œè¡¨ç°å‡ºè¾ƒå¥½çš„å­¦ä¹ å‚ä¸åº¦ã€‚</p>
                <p><strong>äº¤äº’æ¨¡å¼ï¼š</strong>æ‚¨çš„äº¤äº’ä»¥ç‚¹å‡»ä¸ºä¸»ï¼Œè¯´æ˜æ‚¨ä¹ æƒ¯äºä¸»åŠ¨æ¢ç´¢å­¦ä¹ å†…å®¹ã€‚æ»šåŠ¨è¡Œä¸ºé€‚ä¸­ï¼Œæ˜¾ç¤ºè‰¯å¥½çš„å†…å®¹é˜…è¯»ä¹ æƒ¯ã€‚</p>
                <p><strong>å»ºè®®ï¼š</strong>ä¿æŒå½“å‰çš„å­¦ä¹ èŠ‚å¥ï¼Œå¯ä»¥å°è¯•å¢åŠ æ·±åº¦æ€è€ƒçš„æ—¶é—´ã€‚</p>
            `;
            break;
        case 'focus':
            response = `
                <h4>ğŸ¯ ä¸“æ³¨åº¦åˆ†æ</h4>
                <p><strong>ä¸“æ³¨åº¦å¾—åˆ†ï¼š</strong>${averageFocus}/100ï¼Œ${averageFocus > 70 ? 'ä¸“æ³¨åº¦ä¼˜ç§€' : averageFocus > 50 ? 'ä¸“æ³¨åº¦è‰¯å¥½' : 'éœ€è¦æ”¹å–„ä¸“æ³¨åº¦'}ã€‚</p>
                <p><strong>çŠ¶æ€å˜åŒ–ï¼š</strong>æ‚¨çš„ä¸“æ³¨çŠ¶æ€ç›¸å¯¹ç¨³å®šï¼Œé¡µé¢ç„¦ç‚¹å˜åŒ–è¾ƒå°‘ï¼Œè¯´æ˜å­¦ä¹ æ—¶ä¸“å¿ƒè‡´å¿—ã€‚</p>
                <p><strong>å»ºè®®ï¼š</strong>${averageFocus < 70 ? 'å»ºè®®å‡å°‘å¹²æ‰°æºï¼Œåˆ›é€ æ›´å¥½çš„å­¦ä¹ ç¯å¢ƒã€‚' : 'ç»§ç»­ä¿æŒè‰¯å¥½çš„ä¸“æ³¨ä¹ æƒ¯ï¼'}</p>
            `;
            break;
        case 'quiz':
            response = `
                <h4>âœï¸ ç­”é¢˜æ¨¡å¼åˆ†æ</h4>
                <p><strong>ç­”é¢˜é€Ÿåº¦ï¼š</strong>æ‚¨çš„ç­”é¢˜èŠ‚å¥é€‚ä¸­ï¼Œæ˜¾ç¤ºå‡ºè‰¯å¥½çš„æ€è€ƒä¹ æƒ¯ã€‚</p>
                <p><strong>é€‰æ‹©æ¨¡å¼ï¼š</strong>ç­”é¢˜æ—¶æœ‰é€‚å½“çš„çŠ¹è±«å’Œæ€è€ƒï¼Œè¿™æ˜¯æ·±åº¦å­¦ä¹ çš„è¡¨ç°ã€‚</p>
                <p><strong>å»ºè®®ï¼š</strong>ç»§ç»­ä¿æŒæ·±åº¦æ€è€ƒçš„ä¹ æƒ¯ï¼ŒåŒæ—¶å¯ä»¥é€‚å½“æå‡ç­”é¢˜æ•ˆç‡ã€‚</p>
            `;
            break;
        case 'comprehensive':
            response = `
                <h4>ğŸ§  ç»¼åˆå­¦ä¹ åˆ†æ</h4>
                <p><strong>æ•´ä½“è¡¨ç°ï¼š</strong>æ‚¨åœ¨æœ¬æ¬¡å­¦ä¹ ä¼šè¯ä¸­è¡¨ç°å‡ºè‰¯å¥½çš„å­¦ä¹ çŠ¶æ€ï¼Œäº¤äº’ç§¯æï¼Œä¸“æ³¨åº¦è¾ƒé«˜ã€‚</p>
                <p><strong>å­¦ä¹ ç‰¹å¾ï¼š</strong></p>
                <ul>
                    <li>å­¦ä¹ å‚ä¸åº¦ï¼š${totalInteractions > 20 ? 'é«˜' : 'ä¸­ç­‰'}ï¼ˆäº¤äº’æ¬¡æ•°${totalInteractions}ï¼‰</li>
                    <li>ä¸“æ³¨ç»´æŒï¼š${averageFocus > 70 ? 'ä¼˜ç§€' : 'è‰¯å¥½'}ï¼ˆä¸“æ³¨åº¦${averageFocus}%ï¼‰</li>
                    <li>ä¼šè¯æ—¶é•¿ï¼š${sessionDuration}åˆ†é’Ÿï¼Œæ—¶é•¿åˆé€‚</li>
                </ul>
                <p><strong>ä¸ªæ€§åŒ–å»ºè®®ï¼š</strong></p>
                <ul>
                    <li>ä¿æŒå½“å‰çš„å­¦ä¹ èŠ‚å¥å’Œä¸“æ³¨åº¦</li>
                    <li>é€‚å½“å¢åŠ æ€è€ƒæ—¶é—´ï¼Œæ·±åŒ–ç†è§£</li>
                    <li>å®šæœŸå›é¡¾å­¦ä¹ æ•°æ®ï¼ŒæŒç»­ä¼˜åŒ–å­¦ä¹ ç­–ç•¥</li>
                </ul>
            `;
            break;
    }
    
    showAIResponse(response);
}
    </script>
</body>
</html>